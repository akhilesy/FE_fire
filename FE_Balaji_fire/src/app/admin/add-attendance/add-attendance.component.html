<section class="container mt-4">
    <mat-card class="shadow-lg">
      
      <mat-card-content>
        <div *ngIf="attendanceList && attendanceList.length > 0">

       

       
            <mat-card-title >
              <h3 class="fw-bold text-center"> Attendance</h3>
            </mat-card-title>
        <!-- Attendance List -->
        <div *ngIf="attendanceList.length > 0" class="mb-4">
          <h5 class="fw-bold">Attendance List</h5>
          <table mat-table [dataSource]="attendanceList" class="mat-elevation-z8 w-100">
            <!-- Site Name Column -->
            <ng-container matColumnDef="siteName">
              <th mat-header-cell *matHeaderCellDef> Site Name </th>
              <td mat-cell *matCellDef="let attendance"> {{ attendance.siteName }} </td>
            </ng-container>
  
            <!-- Employee Name Column -->
            <ng-container matColumnDef="employeeName">
              <th mat-header-cell *matHeaderCellDef> Employee Name </th>
              <td mat-cell *matCellDef="let attendance"> {{ attendance.employeeName }} </td>
            </ng-container>
  
            <!-- Date Column -->
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef> Date </th>
              <td mat-cell *matCellDef="let attendance"> {{ attendance.date | date:'mediumDate' }} </td>
            </ng-container>
  
            <!-- Is Present Column -->
            <ng-container matColumnDef="isPresent">
              <th mat-header-cell *matHeaderCellDef> Present </th>
              <td mat-cell *matCellDef="let attendance"> {{ attendance.isPresent ? 'Yes' : 'No' }} </td>
            </ng-container>
  
            <!-- OT Hours Column -->
            <ng-container matColumnDef="otHours">
              <th mat-header-cell *matHeaderCellDef> OT Hours </th>
              <td mat-cell *matCellDef="let attendance"> {{ attendance.otHours }} </td>
            </ng-container>
  
            <!-- Table Headers and Rows -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>

        <div class="text-center mt-4">
            <button mat-raised-button color="primary" type="submit"
            (click)="onSubmitAttendance()"
             [disabled]="attendanceList.length<0" aria-label="Add attendance">
              Submit 
            </button>
          
          </div>

        </div>

        <hr>
        <!-- Add Attendance Form -->
        <mat-card-title>
            <h3 class="fw-bold text-center">Add Attendance</h3>
          </mat-card-title>
        <form [formGroup]="attendanceForm" (ngSubmit)="addAttendance()">
            <div class="row">
              <!-- Site Name Dropdown -->
              <div class="col-md-6 mb-3">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Site Name</mat-label>
                  <mat-select formControlName="siteName" aria-label="Select site name" required>
                    <mat-option *ngFor="let site of sites" [value]="site">{{ site }}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="attendanceForm.get('siteName')?.touched && attendanceForm.get('siteName')?.hasError('required')">
                    Site Name is required
                  </mat-error>
                </mat-form-field>
              </div>
          
              <!-- Employee Name Dropdown -->
              <div class="col-md-6 mb-3">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Employee Name</mat-label>
                  <mat-select formControlName="employeeName" aria-label="Select employee name" required>
                    <mat-option *ngFor="let employee of employees" [value]="employee">{{ employee }}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="attendanceForm.get('employeeName')?.touched && attendanceForm.get('employeeName')?.hasError('required')">
                    Employee Name is required
                  </mat-error>
                </mat-form-field>
              </div>
          
              <!-- Date -->
              <div class="col-md-6 mb-3">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Date</mat-label>
                  <input
                    matInput
                    [matDatepicker]="picker"
                    formControlName="date"
                    placeholder="Select date"
                    aria-label="Select attendance date"
                    required
                  />
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                  <mat-error *ngIf="attendanceForm.get('date')?.touched && attendanceForm.get('date')?.hasError('required')">
                    Date is required
                  </mat-error>
                </mat-form-field>
              </div>
          
              <!-- Is Present Checkbox -->
              <div class="col-md-6 mb-3">
                <mat-checkbox formControlName="isPresent" aria-label="Mark if present">Present</mat-checkbox>
              </div>
          
              <!-- OT Hours -->
              <div class="col-md-6 mb-3">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>OT Hours</mat-label>
                  <input
                    matInput
                    formControlName="otHours"
                    type="number"
                    placeholder="Enter overtime hours"
                    aria-label="Enter overtime hours"
                    min="0"
                  />
                  <mat-error *ngIf="attendanceForm.get('otHours')?.hasError('min')">
                    OT Hours cannot be less than 0
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          
            <!-- Buttons -->
            <div class="text-center mt-4">
              <button mat-raised-button color="primary" type="submit" [disabled]="attendanceForm.invalid" aria-label="Add attendance">
                Add Attendance
              </button>
              <button mat-raised-button color="warn" type="button" (click)="resetForm()" aria-label="Clear attendance form">
                Clear
              </button>
            </div>
          </form>
          
          
      </mat-card-content>
    </mat-card>
  </section>
  